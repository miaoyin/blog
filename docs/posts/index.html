<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>busee</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="不见它过">
    <meta name="generator" content="Hugo 0.121.2">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    
    
      <link href="/posts/index.xml" rel="alternate" type="application/rss+xml" title="busee" />
      <link href="/posts/index.xml" rel="feed" type="application/rss+xml" title="busee" />
      
    

    
      <link rel="canonical" href="https://www.yongqingking.top/posts/">
    

    <meta property="og:title" content="Posts" />
<meta property="og:description" content="不见它过" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.yongqingking.top/posts/" />

<meta itemprop="name" content="Posts">
<meta itemprop="description" content="不见它过"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content="不见它过"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="pb3-m pb6-l bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        busee
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/" title="首页 page">
              首页
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/posts/" title="归档 page">
              归档
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/categories/" title="分类 page">
              分类
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/tags/" title="标签 page">
              标签
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv3 ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
          Posts
        </h1>
        
          <h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
            不见它过
          </h2>
        
      </div>
    </div>
  </header>


    <main class="pb7" role="main">
      
  <article class="pa3 pa4-ns nested-copy-line-height">
    <section class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray"></section>
    <section class="flex-ns flex-wrap justify-around mt5">
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/cpp/cmake%E5%BC%95%E7%94%A8jansson%E5%BA%93/" class="link black dim">
        cmake引用jansson库
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      在ubuntun系统上使用clion开发c程序, cmake如何引入jansson库
    </div>
    <a href="/posts/cpp/cmake%E5%BC%95%E7%94%A8jansson%E5%BA%93/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/golang/viper%E7%9B%91%E6%8E%A7%E6%96%87%E4%BB%B6%E5%8F%98%E5%8C%96%E5%87%BA%E7%8E%B0%E4%B8%A4%E6%AC%A1%E4%BA%8B%E4%BB%B6/" class="link black dim">
        viper监控文件变化出现两次事件
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      问题描述 监控配置文件变化，如果内容发生了修改，需要及时加载. 使用viper监控文件变化发现了, 对文件修改一次，会出发两次事件.
示例代码 viper.OnConfigChange(func(e fsnotify.Event) { if e.Op &amp; fsnotify.Write != 0 { fmt.Println(&#34;Config file changed:&#34;, e.Name) } }) viper.WatchConfig() 推测原因 检查viper的源码是否存在bug? 未发现异常
两次变化viper读到的内容返回值是否不一样? 发现viper.AllKeys()返回值不一样, 一次为空, 一次正常.
换一个电脑试试? 发现了在公司办公电脑出现，家里电脑不会出现。
解决办法 //使用AllKeys进行过滤 viper.OnConfigChange(func(e fsnotify.Event) { if e.Op &amp; fsnotify.Write != 0 &amp;&amp; viper.AllKeys()&gt;0{ fmt.Println(&#34;Config file changed:&#34;, e.Name) } }) viper.WatchConfig() 总结 公司的办公电脑安装了文件加密软件。我估摸着是它搞了个什么鬼.
佛說大乘無量壽莊嚴清淨平等覺經pdf
净土大经科注2014-doc
净土大经科注2014(mp3)
印光大师十念法（胡小林主讲第1集）
    </div>
    <a href="/posts/golang/viper%E7%9B%91%E6%8E%A7%E6%96%87%E4%BB%B6%E5%8F%98%E5%8C%96%E5%87%BA%E7%8E%B0%E4%B8%A4%E6%AC%A1%E4%BA%8B%E4%BB%B6/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/home/" class="link black dim">
        首页
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      分类 Your content here
标签 
    </div>
    <a href="/posts/home/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/ceph/%E5%9F%BA%E4%BA%8Edocker%E6%90%AD%E5%BB%BAcephfs%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="link black dim">
        
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      ceph分布式文件系统环境搭建
目的 在一台机器上, 利用多块硬盘, 搭建一个cephfs文件系统. 具体来说就是1个mon, 1个mds, 1个mgr, 3个osd
注意 a. 使用vmware会很方便
b. 安装过程中会遇到很多问题，我都没有记录, 尽量安装下面步骤
环境准备 a. vmware虚拟机fedora30
b. 添加3块虚拟机硬盘 /dev/sdb /dev/sdc /dev/sdd (osd最少需要3个,需要有3块磁盘)
c. ceph容器版本 ceph/daemon:latest-luminous
搭建步骤 下载镜像 docker pull ceph/daemon:latest-luminous 挂载硬盘 vmware虚拟机添加硬盘很方便, 直接加就可以. fdisk -l 查看硬盘
清理硬盘
# 格式化 mkfs.xfs /dev/sdb -f mkfs.xfs /dev/sdc -f mkfs.xfs /dev/sdd -f # 如果已经是xfs格式, 上面命令并不能清除已有数据, 需要用zap_device清理 docker run -d --net=host --name=osd0 --rm \ --privileged=true \ -v /dev/:/dev/ \ -e OSD_DEVICE=/dev/sde \ ceph/daemon:latest-luminous zap_device 准备目录 /root/ceph /root/ceph/etc /root/ceph/lib 启动mon (监控节点必需) docker run -d --net=host --name=mon \ -v /root/ceph/etc:/etc/ceph \ -v /root/ceph/lib/:/var/lib/ceph/ \ -e MON_IP=192.
    </div>
    <a href="/posts/ceph/%E5%9F%BA%E4%BA%8Edocker%E6%90%AD%E5%BB%BAcephfs%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/doc/wikijs%E4%BD%BF%E7%94%A8docker%E5%AE%89%E8%A3%85/" class="link black dim">
        
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      描述 wikijs文档有docker-compose安装说明, 实际中会遇到几个问题
wikij官网 https://docs.requarks.io/install/docker
遇到问题 wikijs上传之后的问题如何备份? 需要将本地目录挂入docker, 并在wikijs存储中配置为上传路径.
docker volume如何备份与还原? 需要借助busybox镜像。如果直接从/var/lib/docker/volume目录拷贝会遇到很多问题.
修改之后的docker-compose.yaml version: &#34;3&#34; services: wikidb: image: postgres:11-alpine environment: POSTGRES_DB: wiki POSTGRES_PASSWORD: wikijsrocks POSTGRES_USER: wikijs logging: driver: &#34;none&#34; restart: unless-stopped volumes: - db-data:/var/lib/postgresql/data wiki: image: ghcr.io/requarks/wiki:2 depends_on: - wikidb environment: DB_TYPE: postgres DB_HOST: wikidb DB_PORT: 5432 DB_USER: wikijs DB_PASS: wikijsrocks DB_NAME: wiki restart: unless-stopped volumes: - ./backup:/opt/backup ports: - &#34;80:3000&#34; volumes: db-data: 备份与还原 //备份 docker run --rm -it -v ~/volume-backup:/backup -v /var/lib/docker:/docker busybox tar cfz /backup/volume.
    </div>
    <a href="/posts/doc/wikijs%E4%BD%BF%E7%94%A8docker%E5%AE%89%E8%A3%85/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/golang/docker%E5%AE%89%E8%A3%85influxdb/" class="link black dim">
        
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      influxdb的docker-compose如何配置
新建数据目录 mkdir data-volumne 生成配置文件 docker run --rm influxdb:2.0.8 influxd print-config &gt; config.yml docker-compose配置 docker-compose.yaml内容
version: &#34;2&#34; services: influxdb: image: influxdb:2.0.8 volumes: - ./data-volumne:/var/lib/influxdb2 - ./config.yml:/etc/influxdb2/config.yml - /usr/share/zoneinfo/Asia/Shanghai:/etc/localtime ports: - 8086:8086 environment: DOCKER_INFLUXDB_INIT_MODE: setup DOCKER_INFLUXDB_INIT_USERNAME: my-user DOCKER_INFLUXDB_INIT_PASSWORD: my-password DOCKER_INFLUXDB_INIT_ORG: my-org DOCKER_INFLUXDB_INIT_BUCKET: my-bucket 启动 docker-compose up
目录结构如下 [root@localhost influxdb]# tree . ├── config.yml ├── data-volumne │ ├── engine │ │ └── data │ └── influxd.bolt └── docker-compose.yaml 注意 上面修改influx时区无效，好像不能修改时区，默认都是UTC
佛說大乘無量壽莊嚴清淨平等覺經pdf
净土大经科注2014-doc
    </div>
    <a href="/posts/golang/docker%E5%AE%89%E8%A3%85influxdb/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/golang/gin%E6%94%AF%E6%8C%81prometheus/" class="link black dim">
        
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      起因 gin使用了微服务架构, 如何将自己的服务都监控起来?
疑问列表 grafana是什么, 能做什么? grafana是一个监控平台，支持不同数据源的可视化。也就是说支持从prometheuse,influxdb等数据源, 并将他们的数据形式可视化的图表.
prometheus能做什么? prometheuse是一个监控系统,通过定时http pull采集数据. 并且支持http push.
prometheus和grafana是什么关系? prometheuse是监控系统, 界面展示比较粗糙, grafana主要是可视化, 并且支持多种类型数据源。
gin如何与prometheuse结合? 见后面
gin如何与grafana? grafana不支持直接接入gin服务。需要gin先接入prometheuse，再将prometheus接入grafana。
gin服务的metrics数据格式如何解析? 暂时未找到
gin自定义监控项 略. 不是本文主题
下载安装 grafana https://github.com/grafana/grafana prometheus https://github.com/prometheus/prometheus gin支持prometheuse 修改gin服务代码 import ( ... &#34;github.com/gin-gonic/gin&#34; &#34;github.com/prometheus/client_golang/prometheus/promhttp&#34; ... ) //metrics, promhttp默认可以查看cpu,mem,线程等信息 router.GET(&#34;/metrics&#34;, gin.WrapH(promhttp.Handler())) 2.修改prometheuse配置(prometheuse.yml)
scrape_configs: - job_name: &#34;prometheus-demo&#34; static_configs: - targets: [&#34;192.168.28.26:8011&#34;] 启动服务 a. 启动gin和prometheuse服务后, 访问localhost:9090
b. 在&quot;Expression&quot;输入框选择&quot;go_goroutines&quot;, 点击&quot;Execute&quot;
c. 刚开始数据比较少,可以过一段时间后再刷新页面
佛說大乘無量壽莊嚴清淨平等覺經pdf
净土大经科注2014-doc
此生必看的科学实验-水知道答案
印光大师十念法（胡小林主讲第1集）
    </div>
    <a href="/posts/golang/gin%E6%94%AF%E6%8C%81prometheus/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/golang/gin%E6%97%A5%E5%BF%97%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8zap%E5%86%99%E6%97%A5%E5%BF%97/" class="link black dim">
        
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      描述 gin对外提供了io.Writer接口, 并且默认日志写入到控制台. 如何使用zap写入文件呢? 示例 logger := zap.NewExample() gin.DefaultWriter = &amp;zapio.Writer{Log: logger, Level: zap.DebugLevel} ga.Server = gin.Default() //注意: 要在gin.Default之前, 修改才有效 
    </div>
    <a href="/posts/golang/gin%E6%97%A5%E5%BF%97%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8zap%E5%86%99%E6%97%A5%E5%BF%97/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/golang/goja%E8%83%BD%E5%A4%9F%E5%81%9A%E4%BB%80%E4%B9%88/" class="link black dim">
        
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      goja是什么 goja实现了ECMAScript 5.1(+)
特性 1. 完整支持ECMAScript 5.1 2. 测试通过了ECMAScript官方所有测试用例 3. 支持任何能在babel, typescript编译器中运行任何ES5 4. 支持sourcemap goja能够做什么 执行js表达式 func testExpression(){ //创建运行实例 vm := goja.New() //运行表达式 v, _ := vm.RunString(&#34;2 + 2&#34;) //获得结果 num := v.Export().(int64) //打印结果 fmt.Println(num) } 执行js脚本 func testScript(){ vm := goja.New() registry := new(require.Registry) registry.Enable(vm) vm.RunString(` var console = require(&#39;console&#39;); var num = 2+2; console.log(num); `) } js调用go函数 func Test(a int, b int) int{ return a+b } func testCallGoFunc(){ vm := goja.
    </div>
    <a href="/posts/golang/goja%E8%83%BD%E5%A4%9F%E5%81%9A%E4%BB%80%E4%B9%88/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100 w-30-l mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="/posts/golang/golang%E4%BD%8D%E7%A7%BB%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B0%8F%E5%9D%91/" class="link black dim">
        
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      问题描述 现有int16类型的整数，将它转为两个字节存放。在还原时，一不小心会就被坑了。 错误用法 length := int(keyBytes[cursor] + keyBytes[cursor+1] &lt;&lt;8) 正确用法 keyBytes := []byte{ 16, 1} length := int(uint16(keyBytes[cursor]) + uint16(keyBytes[cursor+1]) &lt;&lt;8) 错误原因 字节byte位移时类型不会自动变化, 先要转换类型再位移。
佛說大乘無量壽莊嚴清淨平等覺經pdf 净土大经科注2014-doc 此生必看的科学实验-水知道答案 印光大师十念法（胡小林主讲第1集）
    </div>
    <a href="/posts/golang/golang%E4%BD%8D%E7%A7%BB%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B0%8F%E5%9D%91/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
    </section>
    <ul class="pagination pagination-default">
      <li class="page-item disabled">
        <a aria-disabled="true" aria-label="First" class="page-link" role="button" tabindex="-1"><span aria-hidden="true">&laquo;&laquo;</span></a>
      </li>
      <li class="page-item disabled">
        <a aria-disabled="true" aria-label="Previous" class="page-link" role="button" tabindex="-1"><span aria-hidden="true">&laquo;</span></a>
      </li>
      <li class="page-item active">
        <a aria-current="page" aria-label="Page 1" class="page-link" role="button">1</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/2/" aria-label="Page 2" class="page-link" role="button">2</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/3/" aria-label="Page 3" class="page-link" role="button">3</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/4/" aria-label="Page 4" class="page-link" role="button">4</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/5/" aria-label="Page 5" class="page-link" role="button">5</a>
      </li>
      <li class="page-item">
        <a href="/posts/page/2/" aria-label="Next" class="page-link" role="button"><span aria-hidden="true">&raquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/posts/page/8/" aria-label="Last" class="page-link" role="button"><span aria-hidden="true">&raquo;&raquo;</span></a>
      </li>
    </ul></article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://www.yongqingking.top/" >
    &copy;  busee 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
